# 使用官方 Python 映像檔作為基礎映像檔
FROM python:3.9-slim-buster

# 設定工作目錄
WORKDIR /app

# 將 requirements.txt 複製到容器中並安裝依賴
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# 將應用程式程式碼複製到容器中
COPY . .

# 定義容器監聽的埠號 (Fly.io/Render 會注入 PORT 環境變數)
ENV PORT 8080
EXPOSE 8080

# 當容器啟動時運行 app.py
# gunicorn 是一個 WSGI HTTP 服務器，推薦用於生產環境的 Flask 應用
# 修正：使用 'python -m gunicorn' 確保 gunicorn 模組被正確找到和執行
CMD ["python", "-m", "gunicorn", "--bind", "0.0.0.0:$(PORT)", "app:app"]